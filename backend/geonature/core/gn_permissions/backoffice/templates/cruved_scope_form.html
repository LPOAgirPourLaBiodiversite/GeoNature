<html>
    {% include "librairies.html" %}    
    <style>
        td,
        th {
          text-align: center;
        }
      </style>
  <body>
      {% include "nav-bar.html" %}    

    <div class="container">

    {% if user.groupe %}
        <h5> CRUVED du groupe {{user.nom_role}} pour le module {{module.module_label}} </h5>
    {% else %}
        <h5> CRUVED de l'utilisateur {{user.nom_role}} {{user.prenom_role}} pour le module {{module.module_label}}</h5>
    {% endif %}

    {% if not user.groupe %}
    <div class="alert alert-warning" role="alert">
      Préferez l'attribution du CRUVED à des groupes plutôt qu'à des utilisateurs
    </div>
    {% endif %}

    {% with messages = get_flashed_messages() %} {% if messages %} {% for
      message in messages %}
      <div class="alert alert-warning" role="alert">{{ message }}</div>
      {% endfor %} {% endif %} {% endwith %} {% block body %}{% endblock %}

      <form action="" method="POST">
        {{ form.csrf_token }} {{ form.hidden_tag() }}
        <table class="table table-striped">
          <thead>
            <th></th>
            <th>Aucune donnée</th>
            <th>Mes données</th>
            <th>Les données de mon organisme</th>
            <th>Toutes les données</th>
          </thead>
          <tbody>
            <tr>
              <td>Créer - Create</td>
              {% for subfield in form.C %}
              <td>{{ subfield }}</td>
              {% endfor %}
            </tr>
            <tr>
              <td>Lire - Read</td>
              {% for subfield in form.R %}
              <td>{{ subfield }}</td>
              {% endfor %}
            </tr>

            <tr>
              <td>Mettre à jour - Update</td>

              {% for subfield in form.U %}
              <td>{{ subfield }}</td>
              {% endfor %}
            </tr>

            <tr>
              <td>Valider - Validate</td>

              {% for subfield in form.V %}
              <td>{{ subfield }}</td>
              {% endfor %}
            </tr>

            <tr>
              <td>Export - Export</td>

              {% for subfield in form.E %}
              <td>{{ subfield }}</td>
              {% endfor %}
            </tr>

            <tr>
              <td>Supprmier - Delete</td>
              {% for subfield in form.D %}
              <td>{{ subfield }}</td>
              {% endfor %}
            </tr>
          </tbody>
        </table>
        {{form.submit(class="form-control btn-success")}}
      </form>

      <h5>Editer le CRUVED par objet </h5> 
      <div class="card card-body" style="flex-direction: inherit !important;">
        <table>
          {% for object in module_objects %}
          <tr>
            <td>
                {{object.code_object}}
            </td>
            <td>
                <a href="{{ url_for('gn_permissions_backoffice.permission_form', id_module=module.id_module, id_role=user.id_role, id_object=object.id_object) }}">
                    <button class="btn btn-primary">
                      Edit
                    </button>
                    </a>            
            </td>
          </tr>
            
          {% endfor %}
        </table>
      </div>

    </div>
  </body>
</html>
